---
title: "Dual Target Cost - Experiment 2"
author: "James D. Dunn"
date: "7 November 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ez)
library(effsize)

experimentData <- read_csv("Experiment2Data.csv")
```

```{r dataprep}
experimentData$Pptno <- factor(experimentData$Pptno)
experimentData$ExpCond <- factor(experimentData$ExpCond)
experimentData$NoTargets <- factor(experimentData$NoTargets)
experimentData$TrialType <- factor(experimentData$TrialType)
levels(experimentData$TrialType) <- c("1IMG","1ID","2ID")


summaryData <- experimentData %>%
  group_by(Pptno,ExpCond,TrialType) %>%
  summarise(mean_Errors = mean(TotalErrors)
            )

conditionMeanData <- summaryData %>%
  group_by(ExpCond,TrialType) %>%
  summarise(mean_Errors = mean(mean_Errors))

conditionSDData <- summaryData %>%
  group_by(ExpCond,TrialType) %>%
  summarise(sd_Errors = sd(mean_Errors))

conditionMeanData$TrialType <- factor(conditionMeanData$TrialType)
levels(conditionMeanData$TrialType) <- c("1IMG","1ID","2ID")

conditionSDData$TrialType <- factor(conditionSDData$TrialType)
levels(conditionSDData$TrialType) <- c("1IMG","1ID","2ID")


```

```{r Demographics}
demographics <- experimentData %>%
  group_by(Pptno) %>%
  summarise(gender = mean(Gender),age = mean(Age))
demographics$gender <- factor(demographics$gender)
levels(demographics$gender) <- c("Female","Male")
summary(demographics)

ageSummary <- demographics %>%
  summarise(meanAge = mean(age), stdAge = sd(age))

glimpse(ageSummary)
```

```{r Overall analysis}
summaryData.ez <- ezANOVA(data = summaryData, dv = .(mean_Errors), wid = .(Pptno), within = .(ExpCond,TrialType), detailed = TRUE, type = 3)
summaryData.ez
```

```{r Real Block analysis}
realData <- summaryData %>%
  filter(ExpCond == "Real")

realData.ez <- ezANOVA(data = realData, dv = .(mean_Errors), wid = .(Pptno), within = .(TrialType), detailed = TRUE, type = 3)
realData.ez

realDataSpread <- realData %>%
  spread(key = TrialType, value = mean_Errors)

t.test(realDataSpread$`1IMG`,realDataSpread$`2ID`, paired=TRUE)
cohen.d(realDataSpread$`1IMG`,realDataSpread$`2ID`, paired=TRUE)

t.test(realDataSpread$`1ID`,realDataSpread$`2ID`, paired=TRUE)
cohen.d(realDataSpread$`1ID`,realDataSpread$`2ID`, paired=TRUE)

t.test(realDataSpread$`1IMG`,realDataSpread$`1ID`, paired=TRUE)
cohen.d(realDataSpread$`1IMG`,realDataSpread$`1ID`, paired=TRUE)
```

```{r Deception Block analysis}
deceptionData <- summaryData %>%
  filter(ExpCond == "Deception")

deceptionData.ez <- ezANOVA(data = deceptionData, dv = .(mean_Errors), wid = .(Pptno), within = .(TrialType), detailed = TRUE, type = 3)
deceptionData.ez

deceptionDataSpread <- deceptionData %>%
  spread(key = TrialType, value = mean_Errors)

t.test(deceptionDataSpread$`1IMG`,deceptionDataSpread$`2ID`, paired=TRUE)
cohen.d(deceptionDataSpread$`1IMG`,deceptionDataSpread$`2ID`, paired=TRUE)

t.test(deceptionDataSpread$`1ID`,deceptionDataSpread$`2ID`, paired=TRUE)
cohen.d(deceptionDataSpread$`1ID`,deceptionDataSpread$`2ID`, paired=TRUE)

t.test(deceptionDataSpread$`1IMG`,deceptionDataSpread$`1ID`, paired=TRUE)
cohen.d(deceptionDataSpread$`1IMG`,deceptionDataSpread$`1ID`, paired=TRUE)

t.test(realDataSpread$`2ID`,deceptionDataSpread$`2ID`, paired=TRUE)
cohen.d(realDataSpread$`2ID`,deceptionDataSpread$`2ID`, paired=TRUE)

```